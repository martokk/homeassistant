##########################################
########## INDOOR TEMPERATURE ############
##########################################
  - alias: indoor_temp_hot
    trigger:
      - platform: state
        entity_id: sensor.indoor_temperature
    condition:
      - condition: template
        value_template: '{{ states.sensor.indoor_temperature.state | int >= states.input_slider.option_indoor_temp_hot.state | int + 1 }}'
      - condition: state
        entity_id: input_boolean.option_temp_controlled_fans
        state: 'on'
    action:
      - service: input_boolean.turn_on
        entity_id: input_boolean.var_indoor_temp_hot

  - alias: indoor_temp_ok
    trigger:
      - platform: state
        entity_id: sensor.indoor_temperature
    condition:
      - condition: template
        value_template: '{{ states.sensor.indoor_temperature.state | int <= states.input_slider.option_indoor_temp_hot.state | int - 1}}'
      - condition: state
        entity_id: input_boolean.option_temp_controlled_fans
        state: 'on'
    action:
      - service: input_boolean.turn_off
        entity_id: input_boolean.var_indoor_temp_hot

##########################################
########## INDOOR TEMPERATURE ############
##########################################
  - alias: circulate_air_start
    trigger:
      - platform: time
        hours: '/3'
        minutes: 00
        seconds: 00
    condition:
      - condition: state
        entity_id: input_boolean.option_circulate_air
        state: 'on'
    action:
      - service: input_boolean.turn_on
        entity_id: input_boolean.var_circulate_air_on
      - delay: '00:10:00'
      - service: input_boolean.turn_off
        entity_id: input_boolean.var_circulate_air_on


##########################################
########## FANS ON/OFF ###################
##########################################

  - alias: fans_turn_on
    trigger:
      - platform: state
        entity_id: input_boolean.var_indoor_temp_hot
        state: 'on'
      - platform: state
        entity_id: input_boolean.var_smoke_session_on
        state: 'on'
      - platform: state
        entity_id: input_boolean.var_circulate_air_on
        state: 'on'
    action:
      - service: switch.turn_on
        entity_id: switch.sonoff_indoor_fan1

  - alias: fans_turn_off
    trigger:
      - platform: state
        entity_id: input_boolean.var_indoor_temp_hot
        state: 'off'
      - platform: state
        entity_id: input_boolean.var_smoke_session_on
        state: 'off'
      - platform: state
        entity_id: input_boolean.var_circulate_air_on
        state: 'off'
    condition:
      - condition: state
        entity_id: input_boolean.var_indoor_temp_hot
        state: 'off'
      - condition: state
        entity_id: input_boolean.var_smoke_session_on
        state: 'off'
      - condition: state
        entity_id: input_boolean.var_circulate_air_on
        state: 'off'
    action:
      - service: switch.turn_off
        entity_id: switch.sonoff_indoor_fan1
