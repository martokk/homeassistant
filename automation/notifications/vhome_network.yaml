##########################################
############# HOME ASSISTANT UPDATE ######
##########################################
  - alias: HOME ASSISTANT Update Notificaiton
    trigger:
      - platform: state
        entity_id: updater.updater
    action:
      - service: script.notify2
        data_template:
          telegram_message: "There is a new update for Home Assistant! http://home-assistant.io/blog/categories/release-notes"
          tts_entity_id: media_player.vlc
          tts_sound: 'intercom_tos.mp3'
          tts_message: "FYI: There is a new update for Home Assistant available!"

##########################################
########## NOTIFICATION OPTIONS ##########
##########################################
  - alias: "Notificaiton Type Changed"
    trigger:
      - platform: state
        entity_id: input_boolean.option_notify2_sms
      - platform: state
        entity_id: input_boolean.option_notify2_email
      - platform: state
        entity_id: input_boolean.option_notify2_telegram
      - platform: state
        entity_id: input_boolean.option_notify2_tts
      - platform: state
        entity_id: input_boolean.option_notify2_chromecast
      - platform: state
        entity_id: input_boolean.option_notify2_lights
    action:
      - service: script.notify2
        data_template:
          flash_color: "cyan"
          entity_id: "group.all_lights"

##########################################
############# VHOME NETWORK ##############
##########################################

  - alias: "Server Service Down"
    trigger:
      - platform: template
        value_template: >
          {% if states.sensor.server_status_alert.state != "" %}
            true
          {%else%}
            false
          {%endif%}
    action:
      - service: script.notify2
        data_template:
          telegram_message: |
            Server Service Down! -
            {{ states.sensor.server_status_alert.state }}

  - alias: "Cloud Service Down"
    trigger:
      - platform: template
        value_template: >
          {% if states.sensor.cloud_status_alert.state != "" %}
            true
          {%else%}
            false
          {%endif%}
    action:
      - service: script.notify2
        data_template:
          telegram_message: |
            Cloud Service Down! -
            {{ states.sensor.cloud_status_alert.state }}

  - alias: "IoT Device Down"
    trigger:
      - platform: template
        value_template: >
          {% if states.sensor.iot_status_alert.state != "" %}
            true
          {%else%}
            false
          {%endif%}
    action:
      - service: script.notify2
        data_template:
          telegram_message: |
            IoT Device Down! -
            {{ states.sensor.iot_status_alert.state }}

  - alias: "Disk Space Low"
    trigger:
      - platform: numeric_state
        entity_id: sensor.sabnzbd_disk_free
        below: 8
    action:
      - condition: template
        value_template: >
          {% if states.automation.disk_space_low.attributes.last_triggered %}
            {% if (as_timestamp(now())-as_timestamp(states.automation.disk_space_low.attributes.last_triggered)) > (2 * 60 * 60)  %}
              true
            {% else %}
              false
            {% endif %}
          {%else%}
            true
          {%endif%}
      - service: script.notify2
        data_template:
          telegram_message: |
            V: Disk Space Low! -
            {{ states.sensor.sabnzbd_disk_free.state }}GB Free
          flood_color: "red"
          blink_color: "magenta"
          tts_entity_id: media_player.vlc
          tts_sound: 'intercom_tos.mp3'
          tts_message: "Warning Disk Space Low! There is only {{ states.sensor.sabnzbd_disk_free.state | int | round(0) }} gigs free on Dell Laptop's V drive."

  - alias: "SpeedTest Speed Low"
    trigger:
      - platform: numeric_state
        entity_id: sensor.speedtables_download
        below: 15
    action:
      - condition: template
        value_template: >
          {% if states.automation.speedtables_speed_low.attributes.last_triggered %}
            {% if (as_timestamp(now())-as_timestamp(states.automation.speedtables_speed_low.attributes.last_triggered)) > (2 * 60 * 60)  %}
              true
            {% else %}
              false
            {% endif %}
          {%else%}
            true
          {%endif%}
      - service: script.notify2
        data_template:
          telegram_message: |
            Speed Test LOW! -
            {{ states.sensor.speedtables_download.state }}Mbit/s
